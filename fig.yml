agave:
  image: agaveapi/apache-ssl-proxy
  command:
  hostname: docker.example.com
  ports:
    - "443:443"
    - "80:80"
  links:
    - jobs
    - apps
    - transforms
    - files
    - monitors
    - systems
    - metadata
    - profiles
    - notifications
    - apidocs
    - logging
    - postits
    - usage
    - tenants
  mem_limit: 1000000000
  volumes:
    - cache/logs/apache:/var/log/httpd
    - config/ssl:/etc/httpd/ssl
jobs:
  image: agaveapi/jobs-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - mongo
    - beanstalkd
    - logging
    - "storage:storage.example.com"
    - "compute:execute.example.com"
  mem_limit: 2000000000
  volumes:
    - cache/logs/jobs:/usr/local/tomcat/logs
apps:
  image: agaveapi/apps-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
    - "storage:storage.example.com"
    - "compute:execute.example.com"
  mem_limit: 1000000000
  volumes:
    - cache/logs/apps:/usr/local/tomcat/logs
transforms:
  image: agaveapi/transforms-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
    - "storage:storage.example.com"
    - "compute:execute.example.com"
  mem_limit: 1000000000
  volumes:
    - cache/logs/transforms:/usr/local/tomcat/logs
files:
  image: agaveapi/files-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
    - "storage:storage.example.com"
    - "compute:execute.example.com"
  mem_limit: 4000000000
  volumes:
    - cache/logs/files:/usr/local/tomcat/logs
monitors:
  image: agaveapi/monitors-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
    - "storage:storage.example.com"
    - "compute:execute.example.com"
  mem_limit: 1000000000
  volumes:
    - cache/logs/monitors:/usr/local/tomcat/logs
systems:
  image: agaveapi/systems-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
    - "storage:storage.example.com"
    - "compute:execute.example.com"
  mem_limit: 1000000000
  volumes:
    - cache/logs/systems:/usr/local/tomcat/logs
metadata:
  image: agaveapi/metadata-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - mongo
    - beanstalkd
    - logging
  mem_limit: 1000000000
  volumes:
    - cache/logs/metadata:/usr/local/tomcat/logs
profiles:
  image: agaveapi/profiles-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
  mem_limit: 1000000000
  volumes:
    - cache/logs/profiles:/usr/local/tomcat/logs
notifications:
  image: agaveapi/notifications-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "8080"
    - "8009"
  links:
    - mysql
    - beanstalkd
    - logging
  mem_limit: 2000000000
  volumes:
    - cache/logs/notifications:/usr/local/tomcat/logs
apidocs:
  image: agaveapi/apidocs-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "80"
  links:
    - logging
  mem_limit: 1000000000
  volumes:
    - cache/logs/apidocs:/var/log/httpd
postits:
  image: agaveapi/postits-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "80"
  links:
    - mysql
    - beanstalkd
    - logging
  mem_limit: 1000000000
  volumes:
    - cache/logs/postits:/var/log/httpd
usage:
  image: agaveapi/usage-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "80"
  links:
    - mysql
    - beanstalkd
    - logging
  mem_limit: 1000000000
  volumes:
    - cache/logs/usage:/var/log/httpd
tenants:
  image: agaveapi/tenants-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "80"
  links:
    - mysql
    - beanstalkd
    - logging
  mem_limit: 1000000000
  volumes:
    - cache/logs/tenants:/var/log/httpd
logging:
  image: agaveapi/logging-api:2.1.0
  command:
  hostname: docker.example.com
  ports:
    - "80"
  links:
    - mysql
    - beanstalkd
  mem_limit: 1000000000
  volumes:
    - cache/logs/logging:/var/log/httpd
mysql:
  image: deardooley/mysql
  hostname: docker.example.com
  ports:
    - "3306:3306"
  environment:
    MYSQL_DATABASE: agave
    MYSQL_USER: agaveuser
    MYSQL_PASSWORD: password
    MYSQL_ROOT_PASSWORD: mysecretpassword
  mem_limit: 1000000000
  volumes:
    - cache/mysql:/var/lib/mysql
mongo:
  image: mongo:2.6
  mem_limit: 1000000000
  volumes:
    - cache/mongo:/data/db
beanstalkd:
  image: agaveapi/beanstalkd
  mem_limit: 2000000000
  volumes:
    - cache/beanstalkd:/data
storage:
  image: agaveapi/centos-base
  hostname: storage.example.com
  mem_limit: 2000000000
  volumes:
    - cache/storage/sftp:/data
  ports:
    - "10033:22"
compute:
  image: agaveapi/slurm
  hostname: execute.example.com
  mem_limit: 4000000000
  volumes:
    - cache/compute/slurm:/scratch
  ports:
    - "10044:22"
